# -*- coding: utf-8 -*-
import scrapy



from IBug.database.vlundata.privatevlun import ExtractPrivateVlun
from IBug.items import IbugPrivateVulnItem
from IBug.webdrivercrawler.md5 import MD5



class PrivateVulnerabilitySpider(scrapy.Spider):
    name = 'privatevulnerability'
    allowed_domains = ['baidu.com']
    start_urls = ['http://www.baidu.com']

    custom_settings = {
        'ROBOTSTXT_OBEY': False
    }

    def parse(self, response):

        extractprivatevlun = ExtractPrivateVlun()
        privatevlunlist = extractprivatevlun.getexcelinfolist()

        for privatevlundict in privatevlunlist:
            privatevlunresult = {}
            privatevlunresult.update(privatevlundict)

            privatevlunresult['p_uuid'] = MD5.get_md5(privatevlunresult['p_ive'])
            privatevlunresult['p_bigtype'] = '自主漏洞'

            yield IbugPrivateVulnItem(privatevlunresult)
